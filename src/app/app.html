<!-- Header -->
<header
	class="w-full max-w-md text-center mb-6 mt-4 flex flex-col items-center relative"
>
	<h1 class="text-3xl font-bold text-blue-400 mb-2">ğŸ›¡ï¸ é˜¿ç“¦éš†èªéŸ³ä¸Šå¸</h1>
	<p class="text-gray-400 text-sm">ä¸å‡†å·çœ‹ï¼Œå·çœ‹çš„äººæ‰‹æŒ‡æœƒè®ŠçŸ­ã€‚</p>
	<button
		class="absolute right-0 top-2 text-xs bg-gray-700 hover:bg-gray-600 border border-gray-600 text-gray-300 px-3 py-1 rounded-full transition-colors flex items-center"
		(click)="toggleRules()"
	>
		<span class="mr-1">ğŸ“œ</span> è¦å‰‡
	</button>
</header>

<!-- Main Content -->
<main class="w-full max-w-md flex flex-col gap-5">
	<!-- Game Setup (Player Count) -->
	<section class="bg-gray-800 p-4 rounded-xl shadow-lg border border-gray-700">
		<h2 class="text-lg font-bold text-gray-200 mb-3 flex items-center">
			<span class="mr-2">ğŸ‘¥</span> éŠæˆ²è¨­ç½®
		</h2>

		<div class="space-y-4">
			<div>
				<div class="flex justify-between items-end mb-2">
					<div class="text-sm text-gray-400">
						ç©å®¶äººæ•¸:
						<span class="text-white font-bold text-2xl ml-1">{{
							playerCount()
						}}</span>
						äºº
					</div>
					<div
						class="text-sm font-bold px-2 py-1 rounded bg-gray-900 border border-gray-600"
					>
						<span class="text-blue-400">ğŸ”µ {{ currentConfig().good }}</span>
						<span class="text-gray-500 mx-1">|</span>
						<span class="text-red-400">ğŸ”´ {{ currentConfig().evil }}</span>
					</div>
				</div>
				<input
					type="range"
					[ngModel]="playerCount()"
					(ngModelChange)="playerCount.set($event)"
					min="5"
					max="10"
					step="1"
					class="w-full mb-1"
				/>
				<div class="flex justify-between text-xs text-gray-500 px-1 font-mono">
					<span>5</span><span>6</span><span>7</span><span>8</span><span>9</span
					><span>10</span>
				</div>
			</div>

			<div
				class="text-sm text-gray-300 bg-gray-900/50 p-3 rounded border border-gray-600 leading-relaxed"
			>
				ğŸ’¡ {{ currentConfig().text }}
			</div>
		</div>
	</section>

	<!-- Voice Settings -->
	<section class="bg-gray-800 p-4 rounded-xl shadow-lg border border-gray-700">
		<h2 class="text-lg font-bold text-gray-200 mb-3 flex items-center">
			<span class="mr-2">ğŸ—£ï¸</span> èªéŸ³è¨­å®š
		</h2>

		<div class="space-y-4">
			<div>
				<label class="block text-sm text-gray-400 mb-1">èªé€Ÿ (Speed)</label>
				<input
					type="range"
					[ngModel]="rate()"
					(ngModelChange)="rate.set($event)"
					min="0.5"
					max="1.5"
					step="0.1"
					class="w-full h-2 rounded-lg appearance-none cursor-pointer"
				/>
				<div class="flex justify-between text-xs text-gray-500 mt-1">
					<span>æ…¢</span>
					<span>æ­£å¸¸</span>
					<span>å¿«</span>
				</div>
			</div>

			<!-- <div>
				<label class="block text-sm text-gray-400 mb-1"
					>èªéŸ³åŒ… (è‹¥ç„¡ä¸­æ–‡è«‹èª¿æ•´ç³»çµ±è¨­å®š)</label
				>
				<select
					[ngModel]="selectedVoiceName()"
					(ngModelChange)="selectedVoiceName.set($event)"
					class="w-full bg-gray-700 text-white rounded p-2 text-sm border border-gray-600 focus:outline-none focus:border-blue-500"
				>
					@for (voice of displayVoices(); track voice.name) {
					<option [value]="voice.name">
						{{ voice.name }} ({{ voice.lang }})
					</option>
					} @empty {
					<option value="">è¼‰å…¥ä¸­...</option>
					}
				</select>
			</div> -->
		</div>
	</section>

	<!-- Role Configuration -->
	<section class="bg-gray-800 p-4 rounded-xl shadow-lg border border-gray-700">
		<div class="flex justify-between items-center mb-3">
			<h2 class="text-lg font-bold text-gray-200 flex items-center">
				<span class="mr-2">ğŸ­</span> è§’è‰²é…ç½®
			</h2>
			<span class="text-xs text-gray-500">(é»æ“Šå•Ÿç”¨ç‰¹æ®Šè§’è‰²)</span>
		</div>
		<div class="grid grid-cols-2 gap-3">
			@for (role of ROLES; track role.id) {
			<div
				class="role-card cursor-pointer border-2 border-gray-600 bg-gray-700 rounded-lg p-3 flex flex-col items-center justify-center gap-2 select-none"
				[class.active]="isRoleActive(role.id)"
				(click)="toggleRole(role.id)"
			>
				<div class="text-3xl">{{ role.icon }}</div>
				<div class="font-bold text-sm">{{ role.name }}</div>
				<div class="text-xs text-gray-400 text-center">{{ role.desc }}</div>
			</div>
			}
		</div>
	</section>

	<!-- Action Area -->
	<section
		class="fixed bottom-0 left-0 w-full bg-gray-900 p-4 border-t border-gray-800 flex flex-col gap-3 shadow-[0_-5px_15px_rgba(0,0,0,0.5)] z-40"
	>
		@if (currentStatus() || isPlaying()) {
		<div
			class="text-center text-yellow-400 font-bold text-lg min-h-[1.75rem]"
			[class.speaking-indicator]="isSpeaking()"
			[style.color]="isSpeaking() ? '#63b3ed' : '#ecc94b'"
		>
			{{ currentStatus() }}
		</div>
		}

		<div class="flex gap-3">
			@if (isPlaying()) {
			<button
				(click)="stopGame()"
				class="flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg transition-colors"
			>
				â¹ åœæ­¢
			</button>
			} @else {
			<button
				(click)="startGame()"
				class="flex-1 bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-4 rounded-lg transition-colors shadow-lg shadow-blue-900/50"
			>
				â–¶ï¸ é–‹å§‹å¤©é»‘
			</button>
			}
		</div>
		<p class="text-center text-xs text-gray-600 pb-2">
			è«‹ç¢ºèªæ‰‹æ©ŸæœªéœéŸ³ä¸”éŸ³é‡å·²é–‹å•Ÿ
		</p>
	</section>

	<!-- Spacer for fixed footer -->
	<div class="h-32"></div>
</main>

<yo-rules-modal #rulesModal></yo-rules-modal>
